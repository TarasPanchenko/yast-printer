/**
 * File:
 *  Write.ycp
 *
 * Module:
 *  Printer configurator
 *
 * Summary:
 *  Miscelaneous tests.
 *
 * Authors:
 *  Petr Blahos <pblahos@suse.cz>
 *
 * $Id$
 *
 */

{
    include "testsuite.ycp";
    map READ = $[
	"target" : $[
	    "size" : -1,
	    "tmpdir" : "/tmp/",
	    "yast2" : nil,
	],
	"sysconfig" : $[
	    "console" : $[
		"CONSOLE_FONT" : "",
		"CONSOLE_SCREENMAP" : "",
		"CONSOLE_UNICODEMAP" : "",
		"CONSOLE_MAGIC" : "",
		"CONSOLE_ENCODING" : "",
	    ],
	    "language" : $[
		"RC_LANG" : "",
		"DEFAULT_LANGUAGE" : "",
	    ],
	],
	"etc" : $[
	    "install_inf" : $[
		"Cmdline" : "",
		"InstMode" : nil,
	    ],
	    "cups" : $[
		"client_conf" : $[
		    "value" : $[
			"ServerName" : "",
		    ],
		],
	    ],
	],
	"probe" : $[
	    "architecture" : "i386",
	    "has_apm" : true,
	    "has_pcmcia" : false,
	    "has_smp" : false,
	    "system" : [],
	    "memory" : [],
	    "cpu" : [],
	    "cdrom" : $[
		"manual" : [],
	    ],
	    "floppy" : $[
		"manual" : [],
	    ],
	],
    ];
    map WRITE = $[];
    map EXEC = $[
	"target" : $[
	    "bash_output" : $[],
	],
    ];
    TESTSUITE_INIT ([READ, WRITE, EXEC], 0);
    import "Pkg";
    import "Printer";
    import "Progress";
    import "Mode";
    import "Spooler";

    Mode::test = true;

    Progress::off ();

    EXEC = $[
	"target" : $[
	    "mkdir" : true,
	    "bash_output": $["exit": 0, "stdout": "", "srderr": "",],
	],
    ];
    READ = $[
	"var" : $[
	    "lib" : $[
		"yast" : $[
		    "unique": []
		]
	    ]
	],
	"init" : $[
	    "scripts" : $[
		"exists" : true,
		"runlevel": $[],
		"comment" : $[],
	    ]
	],
	"target" : $[
	    "string" : "",
	    "tmpdir" : "/tmp",
	    "ycp" : $["" : $["" : $["" : $["filename" : "filename"]]]],
            "size" : 555,
	],
	"targetpkg" : $["installed" : true],
        "ppd" : $[
            "db" : $[
                "changed" : false,
            ],
        ],
	"etc" : $[
	    "cups" : $[
		"client_conf" : $[
		    "value" : $[
			"ServerName" : "",
		    ],
		],
	    ],
	],
    ];

    TEST (``(Spooler::Set ("lprng")), [READ, WRITE, EXEC], 0);

    TEST (``(Printer::Write ()), [READ, WRITE, EXEC], 0);
    DUMP ("====================================================");
    Printer::printcap = [
	$[  "name" : "lp",
	    "uri" : "parallel://dev/lp0",
	    "ppd" : "filename",
	    "changed" : true,
	],
	$[  "name" : "lpx",
	    "uri" : "parallel://dev/lp0",
	    "ppd" : "filename",
	    "changed" : true,
	]
	];
    Printer::index = 1;
    TEST (``(Printer::deletePrinter ()), [READ, WRITE, EXEC], 0);
    TEST (``(Printer::Write ()), [READ, WRITE, EXEC], 0);
    DUMP ("====================================================");
}
