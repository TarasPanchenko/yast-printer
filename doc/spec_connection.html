<HTML>
<HEAD>
   <TITLE>Possible printer connection</TITLE>
   <STYLE type="text/css">
   BODY { 
     color: black;
     background: white
   }
   .todo {
     color: maroon;
     border-width: thin;
   }
   </STYLE>
</HEAD>
<BODY>
<TABLE BORDER WIDTH="100%">
  <TR>
    <TD>Document</TD>
    <TD>Possible printer connection</TD>
  </TR>
  <TR>
    <TD>Author</TD>
    <TD>Jan Holesovsky &lt;kendy@suse.cz&gt;</TD>
  </TR>
  <TR>
    <TD>Id</TD>
    <TD>$Id$</TD>
  </TR>
</TABLE>

<P class=todo><FONT SIZE=-2><U>Note:</U> When you see a text like this, it is a TODO part.
It is still missing or will be rewritten!</FONT></P>

<H2 align=center>Possible printer connection</H2>

<P>Generally you can say, that the printer can be <I>local</I> or connected to
another machine via <I>network</I>.

<DL>
  <DT><B>Local printer</B>
    <DD>
      It means a printer that is connected to the machine's parallel or serial
      port, USB or infrared port.
    <DD>
      <I>Required information:</I> <B>Name of the device</B> (<TT>/dev/lp?</TT>,
        <TT>/dev/ttyS?</TT>, ...)
      <DL>
        <DT>Printer devices can be:
	  <DD><DL>
            <DT><B><A NAME="parallel">Parallel port</A></B>
	      <DD><I>Requires:</I> Parport support module, lp module, proc
	        filesystem support, parport_probe module in the kernel.
	      <DD><I>Autodetection:</I> A list of parallel ports is in
	        <TT>/proc/parport</TT>. The user must choose if there is more
		than one not autoprobed port. <TT>/proc/devices</TT> says
		whether the connected device is a printer or something else.
	      <DD><I>Autoprobe of the printer type:</I> If the printer conforms
	        to the IEEE 1284 specification and <TT>parport_probe</TT>
		module is loaded, the <TT>MODEL</TT> and <TT>MANUFACTURER</TT>
		fields appear in <TT>/proc/parport/?/autoprobe</TT>.
	      <DD><I>Additional info:</I> <TT>(Linux
	        kernel)/Documentation/parport.txt</TT>
              <DD><I>Problems: (in libhd)</I>To probe printer, it is enough to
                do rmmod parport_probe; modprobe parport_probe. But parallel
                port must be configured properly. The problem is  that SuSE
                linux adds line <TT>options parport_pc io=0x3F8 irq=none,none</TT>
                to <tt>/etc/modules.conf</tt>. Therefore if computer has more
                parallel ports or parallel port on other io ports, parallel ports
                do not work.<br>
                <b>Current solution:</b> Parallel port settings are
                read from bios. It helps if there are the only on-board parallel
                ports, or simply parallel ports configurable by bios. <small>Do
                exist non-on-board parallel ports configurable by bios?</small>
                If user has additional parallel ports (e.g. PCI card), this
                approach kills working parallel ports. So we read parallel ports
                options from <tt>/etc/modules.conf</tt> and replace entries found in
                bios. Then we load parport_pc module with read options. Example: <br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 parallel port at 0x3f8 found in
                bios. <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 parallel ports at 0x2f8,
                0xb000, 0xba00 found in <tt>/etc/modules.conf</tt><br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt>parport_pc</tt> is loaded with
                <tt>io=0x3f8,0xb000,0xba00 irq=none,none,none</tt>.<br> <small>Would
                it be possible to remove options parport_pc from
                /etc/modules.conf?</small> 
	    </DL>
	  <DD><DL>
            <DT><B><A NAME="serial">Serial port</A></B>
	      <DD><I>Requires:</I> Serial port support module, proc filesystem
	        support in the kernel.
	      <DD><I>Autodetection:</I> A list of serial ports can be found in
	        <TT>/proc/tty/driver/serial</TT>. The user must choose.
	      <DD><I>Settings:</I> It should be possible to set baud rate,
	        data bits, parity and ?flow control?. Defaults can be set
		according to the printer name set (choosen) by user.
	      <DD><P class=todo><FONT SIZE=-2><I>Autoprobe of the printer type:</I> I'm affraid,
	        it is not possible...</FONT></P>
	      <DD><I>Additional info:</I>
	  </DL>
	  <DD><DL>
            <DT><B>USB</B>
	      <DD><I>Requires:</I> USB support from experimental kernels
	        (2.3.x), proc filesystem support, hotplug.rpm and usbutils.rpm installed.
	      <DD><I>Autodetection:</I> It is possible to get know if there is
	        a printer connected by scanning
		<TT>/proc/bus/usb/devices</TT>. It seems that it is enough to
                have hotplug started in order to autodetection work.
	      <DD><I>Autoprobe of the printer type:</I> There are
	        <TT>Vendor</TT> and <TT>ProdId</TT> fields in
		<TT>/proc/bus/usb/devices</TT>. Sometimes it will not help
		because the printer can be connected through usb-to-printer
		convertor.
	      <DD><I>Additional info:</I>
                <A HREF="http://www.linux-usb.org"><TT>www.linux-usb.org</TT></A>,
                <A HREF="http://www.dynamine.net/linux-usb/HOWTO/x111.html">HOWTO
                about configuring USB printer under Linux</A>
	  </DL>
	  <DD><DL class=todo><FONT SIZE=-2>
            <DT><B>Infrared</B>
	      <DD><I>Requires:</I>
	      <DD><I>Autodetection:</I>
	      <DD><I>Autoprobe of the printer type:</I>
	      <DD><I>Additional info:</I>
	  </FONT></DL>
      </DL>
    <DD><I>Printing:</I> Is provided by sending filtered output to the
      specified device.
</DL>
<DL>
  <DT><B><A NAME="remote">Remote printer</A></B>
    <DD>It means printing on printers connected to a remote host with
      <TT>lpd</TT> running. The printers should be already configured.
    <DD><I>Required information:</I> <B>Name of the remote host</B> and
      <B>name of the remote queue</B>.
    <DD><DL>
      <DT><B>Remote host</B>
        <DD>Name of the remote machine. Configurator can provide a list of
	  machines in user's domain.
	  The remote machine must be set to accept printing requests from
	  user's machine, typically by listing in <TT>/etc/hosts.lpd</TT>
      <DT><B>Remote queue</B>
        <DD><P class=todo><FONT SIZE=-2>Is it possible to get list from the remote host
	  without logging in?</FONT></P>
    </DL>
</DL>
<DL>
  <DT><B><A NAME="prefilter">Prefilter queue for remote printer</A></B>
    <DD>It means printing on printers connected to a remote host with
      <TT>lpd</TT> running. The printers should be already configured.
      Data are filtered on local host and are sent to remote <TT>raw</TT>
      queue. In fact this is combination of two queues, one running on local
      host that actually does filtering and converts data to format that printer
      understand to, and the second, running on remote host, sending raw data
      directly to printer.
    <DD><I>Required information:</I> <B>Name of the remote host</B> and
      <B>name of the remote queue</B>.
    <DD><DL>
      <DT><B>Remote host</B>
        <DD>Name of the remote machine. Configurator can provide a list of
	  machines in user's domain.
	  The remote machine must be set to accept printing requests from
	  user's machine, typically by listing in <TT>/etc/hosts.lpd</TT>
      <DT><B>Remote queue</B>
        <DD><P class=todo><FONT SIZE=-2>Is it possible to get list from the remote host
	  without logging in?</FONT></P>
    </DL>
</DL>
<DL>
  <DT><B>SMB/Windows 9x/NT printer</B>
    <DD>It means printing on printers connected to SMB servers.
    <DD><I>Required information:</I> <B>Hostname/IP of the SMB server</B>,
      <B>printer name</B>, <B>user and password</B> and <B>workgroup</B>.
    <DD><I>Requires:</I> the <TT>samba</TT> package installed,
      networking.
    <DD><DL>
      <DT><B>Hostname/IP</B>
	<DD><I>Autodetection:</I> The lookup can be done by "<TT>nmblookup -M
	-</TT>" followed by "<TT>nmblookup -A &lt;ip address&gt;</TT>", where
	the &lt;ip address&gt; is get from the previous nmblookup.
	<P class=todo><FONT SIZE=-2>Is it neccessary to let user to be able to
	select his own setting?</FONT></P>
      <DT><B>Printer name</B>
	<DD><I>Autodetection:</I> In <TT>smbclient -N -L &lt;name&gt;</TT> list,
	  there are names of connected printers there. 
	<DD><I>Autoprobe of the printer type:</I>
	  <P class=todo><FONT SIZE=-2>It is possible in Samba to specify the
	  printer driver name. Is it possible to obtain it?</FONT></P>
      <DT><B>User and password</B>
        <DD>The setup tool should recommend to create a special user and
	  password! (because of security)
      <DT><B>Workgroup</B>
        <DD>A list of workgroups can be provided using<TT>smbclient -N -L
	&lt;name&gt;</TT>.
    </DL>
    <DD><I>Printing:</I> Is provided by sending filtered output to
      <TT>smbclient</TT>.
    <DD><I>Additional info:</I> <TT>(samba.tar.gz)/examples/printing</TT>,
      <TT>man smbclient</TT>
</DL>
<DL>
  <DT><B>NetWare printer (NCP)</B>
    <DD>Printing on printers connected to NetWare servers.
    <DD><I>Required information:</I> <B>Printer server name</B>, <B>print
      queue name</B> and <B>user and password</B>.
    <DD><I>Requires:</I> the <TT>cnpfs</TT> package installed,
      networking.
    <DD><DL>
      <DT><B>Printer server name</B>
        <DD><I>Autodetection:</I> A list of available NCP servers can be get
	  using <TT>slist</TT>.
      <DT><B>Print queue name</B>
        <DD><I>Autodetection:</I> A list of available queues on specified
	  server can be get using <TT>pqlist</TT>.
	<DD><P class=todo><FONT SIZE=-2><I>Autoprobe of the printer type:</I>
	  I haven't found a word about it...</FONT></P>
      <DT><B>User and password</B>
        <DD>Recommend to create a special user and password! (because of
          security)
    </DL>
    <DD><I>Printing:</I> Is provided by sending filtered output to
      <TT>nprint</TT>.
</DL>
<DL class=todo><FONT SIZE=-2>
  <DT><B>Direct to port printer (HP JetDirect or AppSocket protocol)</B>
    <DD>Printing on printers connected ???directly???.
      <B><I>TODO</I></B> get known how does it work.
    <DD><I>Required information:</I> <B>Hostname of the printer</B> and
      <B>port of the printer</B>.
    <DD><DL>
      <DT><B>Hostname of the printer</B>
      <DT><B>Port of the printer</B>
        <DD>(Default: 9100)
    </DL>
</FONT></DL>

<DL class=todo><FONT SIZE=-2>
  <DT><B>Internet Printing Protocol printers</B>
    <DD><I>Requires:</I> CUPS system plus <a
      href="http://www.geocities.com/SiliconValley/8036/cups_page.html">CUPS-filters</a>
    <DD><I>Autodetection:</I> I guess no. See <a href="http://www.pwg.org/ipp/">Internet
      Printing Protocol</a>
    <DD><I>Settings:</I> Network Configuration, Printer Security, File
      Formats, etc ... <a href="http://www.cups.org">(Internet Printing
      Protocol)</a>
    <DD><B>Warning:</B> Installing CUPS will overwrite your existing printing
      system.
    <DD><I>Additional info:</I>
      <A HREF="http://www.cups.org"><TT>www.cups.org</TT></A>, 
      <A HREF="ftp://ftp.isi.edu/in-notes/rfc2569.txt">RFC 2569</A>
</FONT></DL>

<DL class=todo><FONT SIZE=-2>
  <DT><B>Printer Access Protocol printers</B>
    <DD>Printing on AppleTalk connected printers.
    <DD><I>Requires:</I>
    <DD><I>Autodetection:</I>
    <DD><I>Additional info:</I> <TT>man pap</TT>, <TT>rpm -ql netatalk</TT>
</FONT></DL>

<H2 align=center>Functionality necessary for autodetection</H2>
<P>All autodetection is possible by scanning files and scanning of the output
of programs described above.

</BODY>
</HTML>
